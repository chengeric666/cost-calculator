# GECOMæ•°æ®ä½¿ç”¨è§„èŒƒæ–‡æ¡£

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0ï¼ˆæ–°å¢ä»£ç ç¼–å†™è§„èŒƒ+æ–‡æ¡£ç®¡ç†è§„åˆ™ï¼‰
**åˆ›å»ºæ—¥æœŸ**: 2025-11-13ï¼ˆv1.0ï¼‰| 2025-11-14ï¼ˆv2.0æ›´æ–°ï¼‰
**æ–‡æ¡£ç±»å‹**: æŠ€æœ¯è§„èŒƒï¼ˆé•¿æœŸç»´æŠ¤ï¼‰
**å¯¹åº”ä»»åŠ¡**: GECOM-W4-D20P-T2.1 + Day 21 Phase 2-3
**SSOTé“¾æ¥**: [MVP-2.0-ä»»åŠ¡æ¸…å•.md Day 20+ Phase 2](./MVP-2.0-ä»»åŠ¡æ¸…å•.md#phase-2-åˆ›å»ºæ•°æ®ä½¿ç”¨è§„èŒƒæ–‡æ¡£30min)
**çŠ¶æ€**: âœ… å·²å®Œæˆï¼ˆv2.0æ–°å¢ï¼šæ¡ä»¶æ¸²æŸ“è§„èŒƒ+æ–‡æ¡£ç®¡ç†3å±‚è§„åˆ™ï¼‰

---

## ğŸ“‹ æ–‡æ¡£åˆ†å±‚è¯´æ˜

> **é‡è¦æç¤º**: æœ¬æ–‡æ¡£æ˜¯**ç¬¬3å±‚è§„èŒƒæ–‡æ¡£**ï¼Œå±äºé•¿æœŸç»´æŠ¤çš„æŠ€æœ¯è§„èŒƒã€‚å…³äºGECOMé¡¹ç›®çš„æ–‡æ¡£ç®¡ç†ä½“ç³»ï¼Œè¯·å‚è€ƒä»¥ä¸‹åˆ†å±‚ï¼š

**æ–‡æ¡£åˆ†å±‚ä½“ç³»**:
```
ç¬¬1å±‚ï¼šæ‰§è¡Œè¿½è¸ªï¼ˆSSOTï¼‰
â””â”€ MVP-2.0-ä»»åŠ¡æ¸…å•.md - å”¯ä¸€çœŸç›¸æ¥æºï¼Œæ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡ŒçŠ¶æ€è¿½è¸ª

ç¬¬2å±‚ï¼šè®¾è®¡åˆ†æï¼ˆå‚è€ƒæ–‡æ¡£ï¼‰
â”œâ”€ DATA-LOADING-ROOT-CAUSE-ANALYSIS-2025-11-13.md - é—®é¢˜æ ¹å› åˆ†æ
â”œâ”€ ULTRA-THINK-ANALYSIS-2025-11-13.md - æ·±åº¦æŠ€æœ¯è°ƒç ”
â””â”€ å…¶ä»–*-ANALYSIS.mdæ–‡æ¡£

ç¬¬3å±‚ï¼šè§„èŒƒæŒ‡å—ï¼ˆé•¿æœŸæ–‡æ¡£ï¼‰â­ æœ¬æ–‡æ¡£æ‰€åœ¨å±‚çº§
â”œâ”€ DATA-USAGE-SPECIFICATION.md - æ•°æ®ä½¿ç”¨è§„èŒƒ
â”œâ”€ DATA-COLLECTION-STANDARD.md - æ•°æ®é‡‡é›†æ ‡å‡†
â””â”€ å…¶ä»–*-SPECIFICATION.mdæ–‡æ¡£

ç¬¬4å±‚ï¼šä¸´æ—¶æ¸…å•ï¼ˆâŒ ç¦æ­¢åˆ›å»ºï¼‰
â””â”€ ç‹¬ç«‹ä»»åŠ¡è¿½è¸ªæ–‡ä»¶è¿åSSOTåŸåˆ™
```

**æœ¬æ–‡æ¡£å®šä½**: æä¾›GECOMé¡¹ç›®ä¸­æ•°æ®å¯¼å…¥ã€ä½¿ç”¨å’Œç®¡ç†çš„æ ‡å‡†åŒ–è§„èŒƒï¼Œé˜²æ­¢æ•°æ®åŠ è½½é”™è¯¯ï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚

---

## ğŸ¯ è§„èŒƒç›®çš„

**æ ¸å¿ƒé—®é¢˜**: 2025-11-13å‘ç°Step2DataCollectionç»„ä»¶æ•°æ®åŠ è½½é”™è¯¯ï¼Œæ ¹æœ¬åŸå› æ˜¯è¿åäº†3å±‚æ•°æ®æ¶æ„è®¾è®¡ç†å¿µï¼Œå¯¼è‡´ï¼š
- M1æˆæœ¬é¡¹æ˜¾ç¤º0ä½†æ€»è®¡1450ï¼ˆç¼ºå¤±800 USDè¡Œä¸šè®¸å¯è´¹ï¼‰
- Tierå¾½ç« æ˜¾ç¤º"æ•°æ®åº“é¢„è®¾"è€ŒéçœŸå®æ•°æ®æº

**è§„èŒƒç›®æ ‡**:
1. âœ… æ˜ç¡®æ•°æ®å¯¼å…¥çš„æ­£ç¡®æ¨¡å¼ï¼ˆå®Œæ•´å¯¼å…¥ > é€‰æ‹©æ€§å¤åˆ¶ï¼‰
2. âœ… é˜²æ­¢å­—æ®µæ˜ å°„é”™è¯¯ï¼ˆç»Ÿä¸€å‘½åè§„èŒƒï¼‰
3. âœ… ç¡®ä¿æ•°æ®æº¯æºå®Œæ•´ï¼ˆdata_sourceå­—æ®µ100%å¡«å……ï¼‰
4. âœ… æä¾›å¯å¤åˆ¶çš„ä»£ç ç¤ºä¾‹ï¼ˆé™æ€+åŠ¨æ€åŠ è½½ï¼‰

---

## ğŸ“Š ç¬¬1ç« ï¼š3å±‚æ•°æ®æ¶æ„è¯´æ˜

GECOMé¡¹ç›®é‡‡ç”¨**ä¸‰å±‚æ•°æ®æ¶æ„**è®¾è®¡ï¼Œç¡®ä¿æ•°æ®å®Œæ•´æ€§ã€æ€§èƒ½å’Œå¯æ‰©å±•æ€§ï¼š

### Layer 1: TypeScriptæºæ–‡ä»¶ï¼ˆå•ä¸€çœŸç›¸æ¥æºï¼‰

```
ä½ç½®: gecom-assistant/data/cost-factors/
æ–‡ä»¶æ¨¡å¼: 3æ–‡ä»¶æ¶æ„ï¼ˆæ¯å›½Ã—æ¯è¡Œä¸šï¼‰
â”œâ”€ XX-base-data.ts          # 35ä¸ªé€šç”¨å­—æ®µï¼ˆè·¨è¡Œä¸šå¤ç”¨ï¼‰
â”œâ”€ XX-{industry}-specific.ts # 55ä¸ªè¡Œä¸šç‰¹å®šå­—æ®µ
â””â”€ XX-{industry}.ts         # 90+ä¸ªåˆå¹¶å­—æ®µï¼ˆå®Œæ•´æ•°æ®ï¼‰

ç‰¹ç‚¹:
- å­—æ®µæ•°: 127å­—æ®µï¼ˆP0: 67å­—æ®µ + P1: 30å­—æ®µ + P2: 30å­—æ®µï¼‰
- ç‰ˆæœ¬æ§åˆ¶: Git
- æ•°æ®è´¨é‡: Tier 1/2/3åˆ†çº§ï¼Œ100%æº¯æºä¿¡æ¯
- ç”¨é€”: æ•°æ®æºå¤´ï¼Œå¼€å‘ç¯å¢ƒç›´æ¥å¯¼å…¥
```

**3æ–‡ä»¶æ¶æ„åˆå¹¶é€»è¾‘**:
```typescript
// XX-{industry}.tsæ ‡å‡†æ¨¡æ¿
import { XX_BASE_DATA } from './XX-base-data';
import { XX_{INDUSTRY}_SPECIFIC } from './XX-{industry}-specific';

export const XX_{INDUSTRY}: any = {
  // åŸºç¡€å…ƒæ•°æ®
  country: 'XX',
  country_name_cn: 'å›½å®¶åç§°',
  country_flag: 'ğŸ‡½ğŸ‡½',
  industry: '{industry}',
  version: '2025Q1',

  // æ•°æ®æº¯æº
  collected_at: '2025-11-09T10:00:00+08:00',
  collected_by: 'Claude AI + Manual Research',
  verified_at: '2025-11-09T21:00:00+08:00',

  // â­ å…³é”®ï¼šä½¿ç”¨spread operatorå®Œæ•´åˆå¹¶
  ...XX_BASE_DATA,           // 35é€šç”¨å­—æ®µï¼ˆä¼˜å…ˆçº§ä½ï¼‰
  ...XX_{INDUSTRY}_SPECIFIC,  // 55ç‰¹å®šå­—æ®µï¼ˆä¼˜å…ˆçº§é«˜ï¼Œä¼šè¦†ç›–å†²çªå­—æ®µï¼‰

  // æ•°æ®è´¨é‡æ‘˜è¦
  data_quality_summary: {
    total_fields: 90,
    p0_fields: 67,
    p0_fields_filled: 67,
    tier1_count: 47,
    tier2_count: 41,
    tier3_count: 2,
    confidence_score: 0.88,
  },
};
```

### Layer 2: Appwriteæ•°æ®åº“ï¼ˆæ ¸å¿ƒè®¡ç®—ï¼‰

```
Collection: cost_factors (ID: 690d4fdd0035c2f63f20)
å­—æ®µ: 67ä¸ªP0æ ¸å¿ƒå­—æ®µï¼ˆ42%ï¼‰
è¦†ç›–: M1-M8æ‰€æœ‰å¿…éœ€è®¡ç®—å­—æ®µ
è®¿é—®: Appwrite SDK (getCostFactor, getCostFactorsByCountries)
ç”¨é€”: ç”Ÿäº§ç¯å¢ƒæˆæœ¬è®¡ç®—ï¼ŒæŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–
```

**å­—æ®µè¿‡æ»¤è§„åˆ™**:
- âœ… åŒ…å«ï¼šæ‰€æœ‰P0å­—æ®µï¼ˆGECOMè®¡ç®—å¼•æ“ä¾èµ–ï¼‰
- âœ… åŒ…å«ï¼šæ•°æ®æº¯æºå­—æ®µï¼ˆm*_data_source, m*_tier, m*_collected_atï¼‰
- âŒ æ’é™¤ï¼šP1/P2æ‰©å±•å­—æ®µï¼ˆå¸‚åœºæ´å¯Ÿã€é«˜çº§åˆ†æï¼‰
- âŒ æ’é™¤ï¼šdata_quality_summaryï¼ˆä»…TypeScriptéœ€è¦ï¼‰

### Layer 3: JSONæ‰©å±•æ–‡ä»¶ï¼ˆè¯¦ç»†æ•°æ®ï¼‰

```
ä½ç½®: gecom-assistant/public/data/{industry}-extended/
æ–‡ä»¶: XX-{industry}-extended.json
å­—æ®µ: 84ä¸ªæ‰©å±•å­—æ®µï¼ˆ58%ï¼‰
è®¿é—®: fetch() HTTPè¯·æ±‚
ç”¨é€”: å¸‚åœºè¯¦æƒ…é¡µã€é«˜çº§æŠ¥å‘Šã€æ•°æ®æ´å¯Ÿ
```

**æ‰©å±•å­—æ®µç¤ºä¾‹**:
```json
{
  "country": "US",
  "industry": "vape",
  "extended": {
    "market_summary": "ç¾å›½ç”µå­çƒŸå¸‚åœºè§„æ¨¡$127äº¿...",
    "m1_fda_pmta_usd": 50000000,
    "m1_pmta_approval_rate": 0.01,
    "m6_amazon_banned": true,
    "m6_shopify_restrictions": "éœ€KYCéªŒè¯...",
    "regulatory_timeline": {...},
    "competitive_landscape": {...}
  }
}
```

### ä¸‰å±‚æ¶æ„æ•°æ®æµ

```
å¼€å‘ç¯å¢ƒï¼ˆå¿«é€Ÿè¿­ä»£ï¼‰:
Component â†’ import VN_PET_FOOD (Layer 1) â†’ å®Œæ•´127å­—æ®µ

ç”Ÿäº§ç¯å¢ƒï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰:
Component â†’ loadCostFactor('VN', 'pet_food', { includeExtended: false })
           â†’ AppwriteæŸ¥è¯¢ (Layer 2) â†’ 67æ ¸å¿ƒå­—æ®µ â†’ æˆæœ¬è®¡ç®—

é«˜çº§åŠŸèƒ½ï¼ˆå®Œæ•´æ•°æ®ï¼‰:
Component â†’ loadCostFactor('VN', 'pet_food', { includeExtended: true })
           â†’ AppwriteæŸ¥è¯¢ (Layer 2) + fetch JSON (Layer 3)
           â†’ 67æ ¸å¿ƒ + 84æ‰©å±• = 151å­—æ®µ â†’ å¸‚åœºè¯¦æƒ…å±•ç¤º
```

---

## ğŸ”§ ç¬¬2ç« ï¼šæ•°æ®å¯¼å…¥è§„èŒƒï¼ˆ4ä¸ªæ ¸å¿ƒè§„èŒƒï¼‰

### è§„èŒƒ1: å¯¼å…¥mergedæ–‡ä»¶ä¼˜äºbaseæ–‡ä»¶ï¼ˆâ­ å¼ºåˆ¶ï¼‰

**é”™è¯¯åšæ³•**âŒ:
```typescript
// åªå¯¼å…¥baseæ–‡ä»¶ï¼Œç¼ºå¤±55ä¸ªè¡Œä¸šç‰¹å®šå­—æ®µ
import { VN_BASE_DATA } from '@/data/cost-factors/VN-base-data';
const costFactor = { ...VN_BASE_DATA };
// ç»“æœï¼šç¼ºå°‘m4_hs_code, m6_cac_usd, m1_industry_license_usdç­‰55ä¸ªå­—æ®µ
```

**é”™è¯¯åšæ³•**âŒ:
```typescript
// æ‰‹åŠ¨åˆå¹¶base + specificï¼Œç¹çä¸”æ˜“é”™
import { VN_BASE_DATA } from '@/data/cost-factors/VN-base-data';
import { VN_PET_FOOD_SPECIFIC } from '@/data/cost-factors/VN-pet-food-specific';
const costFactor = {
  ...VN_BASE_DATA,
  ...VN_PET_FOOD_SPECIFIC,
  // è¿˜éœ€æ‰‹åŠ¨æ·»åŠ å…ƒæ•°æ®å­—æ®µ...
};
```

**æ­£ç¡®åšæ³•**âœ…:
```typescript
// å¯¼å…¥mergedæ–‡ä»¶ï¼Œå®Œæ•´90+å­—æ®µï¼Œä¸€æ¬¡å¯¼å…¥
import { VN_PET_FOOD } from '@/data/cost-factors/VN-pet-food';
const costFactor: CostFactor = {
  ...VN_PET_FOOD  // å®Œæ•´90+å­—æ®µï¼ŒåŒ…å«base + specific + å…ƒæ•°æ®
};
```

**ç†ç”±**:
- Mergedæ–‡ä»¶å·²ç»æ­£ç¡®å¤„ç†base + specificä¼˜å…ˆçº§ï¼ˆspecificè¦†ç›–baseï¼‰
- åŒ…å«å®Œæ•´æ•°æ®è´¨é‡å…ƒæ•°æ®ï¼ˆdata_quality_summaryï¼‰
- åŒ…å«æ•°æ®æº¯æºä¿¡æ¯ï¼ˆcollected_at, collected_by, verified_atï¼‰
- ç¬¦åˆ3å±‚æ¶æ„è®¾è®¡ç†å¿µï¼šå®Œæ•´æ€§ > ç²¾ç®€æ€§

---

### è§„èŒƒ2: å®Œæ•´spreadå¯¼å…¥ä¼˜äºæ‰‹åŠ¨é€‰æ‹©å­—æ®µï¼ˆâ­ å¼ºåˆ¶ï¼‰

**é”™è¯¯åšæ³•**âŒ:
```typescript
// æ‰‹åŠ¨é€‰æ‹©å­—æ®µï¼Œç¼ºå¤±90%å­—æ®µ
const costFactor: Partial<CostFactor> = {
  country: 'VN',
  country_name_cn: VN_BASE_DATA.country_name_cn,
  industry: project.industry,

  // âŒ åªè®¾ç½®èšåˆå­—æ®µ
  m1_estimated_cost_usd: VN_BASE_DATA.m1_company_registration_usd +
                         VN_BASE_DATA.m1_business_license_usd +
                         VN_BASE_DATA.m1_legal_consulting_usd,  // = 1450
  m1_tier: VN_BASE_DATA.m1_base_tier,

  // âŒ ç¼ºå¤±æ˜ç»†å­—æ®µï¼š
  // m1_company_registration_usd: æœªè®¾ç½® â†’ UIæ˜¾ç¤º0
  // m1_business_license_usd: æœªè®¾ç½® â†’ UIæ˜¾ç¤º0
  // m1_industry_license_usd: æœªè®¾ç½® â†’ UIæ˜¾ç¤º0ï¼ˆå®é™…åº”è¯¥800ï¼‰

  // âŒ ç¼ºå¤±æº¯æºå­—æ®µï¼š
  // m1_data_source: æœªè®¾ç½® â†’ Tierå¾½ç« æ˜¾ç¤º"æ•°æ®åº“é¢„è®¾"
  // m1_base_data_source: æœªè®¾ç½®
  // m1_collected_at: æœªè®¾ç½®
};
```

**æ­£ç¡®åšæ³•**âœ…:
```typescript
// å®Œæ•´spreadå¯¼å…¥ï¼Œä¿æŒæ•°æ®å®Œæ•´æ€§
import { VN_PET_FOOD } from '@/data/cost-factors/VN-pet-food';

const costFactor: CostFactor = {
  // âœ… å®Œæ•´å¯¼å…¥90+å­—æ®µï¼ˆåŒ…æ‹¬æ‰€æœ‰æ˜ç»†å’Œæº¯æºï¼‰
  ...VN_PET_FOOD,

  // å¯é€‰ï¼šåŠ¨æ€è¦†ç›–ç‰¹å®šå­—æ®µ
  industry: project.industry as Industry,  // å¦‚éœ€è¿è¡Œæ—¶åˆ‡æ¢
  version: '2025Q1',
};
```

**å­—æ®µæ˜ å°„ç¤ºä¾‹**ï¼ˆå¦‚éœ€UIå­—æ®µåä¸æ•°æ®å­—æ®µåä¸åŒ¹é…ï¼‰:
```typescript
const costFactor: CostFactor = {
  ...VN_PET_FOOD,

  // â­ å­—æ®µæ˜ å°„ï¼šæ•°æ®æºå­—æ®µï¼ˆåŸºäºçœŸå®å­—æ®µåï¼Œspecific > baseï¼‰
  m1_data_source: (VN_PET_FOOD as any).m1_industry_data_source ||
                 (VN_PET_FOOD as any).m1_base_data_source ||
                 'MARDå®˜ç½‘ + è¶Šå—è¿›å£ä»£ç†å…¬å¸æŠ¥ä»·',

  m2_data_source: (VN_PET_FOOD as any).m2_product_certification_data_source ||
                 (VN_PET_FOOD as any).m2_compliance_data_source ||
                 (VN_PET_FOOD as any).m2_trademark_data_source ||
                 'NAFIQADå®˜æ–¹æ”¶è´¹æ ‡å‡† + SGSè¶Šå—å®éªŒå®¤æŠ¥ä»·',

  // â­ å­—æ®µæ˜ å°„ï¼šè¡Œä¸šè®¸å¯è´¹ï¼ˆæ•°æ®å­—æ®µå â†’ UIæœŸæœ›å­—æ®µåï¼‰
  m1_import_license_cost_usd: (VN_PET_FOOD as any).m1_industry_license_usd || 0,
  m1_import_license_required: (VN_PET_FOOD as any).m1_pre_approval_required || false,
};
```

**ç†ç”±**:
- é¿å…ç¼ºå¤±å­—æ®µå¯¼è‡´UIæ˜¾ç¤ºé”™è¯¯ï¼ˆå¦‚æ˜¾ç¤º0æˆ–undefinedï¼‰
- ä¿æŒæ•°æ®å®Œæ•´æ€§ï¼Œæ”¯æŒæœªæ¥åŠŸèƒ½æ‰©å±•ï¼ˆä¸éœ€è¦ä¿®æ”¹æ•°æ®åŠ è½½é€»è¾‘ï¼‰
- å‡å°‘ç»´æŠ¤æˆæœ¬ï¼ˆæ•°æ®æ–‡ä»¶æ›´æ–°è‡ªåŠ¨ç”Ÿæ•ˆï¼Œæ— éœ€æ‰‹åŠ¨åŒæ­¥ï¼‰
- ç¡®ä¿æ•°æ®æº¯æºå®Œæ•´ï¼ˆdata_sourceå­—æ®µ100%å¡«å……ï¼‰

---

### è§„èŒƒ3: ä½¿ç”¨loadCostFactor()å·¥å…·æ”¯æŒåŠ¨æ€åŠ è½½ï¼ˆæ¨èï¼‰

**é€‚ç”¨åœºæ™¯**: Step 0åˆ‡æ¢å›½å®¶/è¡Œä¸šæ—¶è‡ªåŠ¨åŠ è½½å¯¹åº”æ•°æ®

**åŠ¨æ€åŠ è½½Hook**:
```typescript
// gecom-assistant/hooks/useCountryData.ts
import { loadCostFactor } from '@/lib/data-loader';

export function useCountryData(country: TargetCountry, industry: Industry) {
  const [data, setData] = useState<CostFactor | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<Error | null>(null);

  useEffect(() => {
    const loadData = async () => {
      try {
        setLoading(true);
        const costFactor = await loadCostFactor(
          country,
          industry,
          { includeExtended: false }  // Layer 2: æ ¸å¿ƒ67å­—æ®µï¼ˆå¿«é€Ÿï¼‰
        );
        setData(costFactor);
      } catch (err) {
        setError(err as Error);
        console.error('æ•°æ®åŠ è½½å¤±è´¥:', err);
      } finally {
        setLoading(false);
      }
    };

    loadData();
  }, [country, industry]);

  return { data, loading, error, reload: () => loadData() };
}
```

**ç»„ä»¶ä½¿ç”¨ç¤ºä¾‹**:
```typescript
// Step2DataCollection.tsx
import { useCountryData } from '@/hooks/useCountryData';

export default function Step2DataCollection({ project }: Props) {
  const { data: costFactor, loading, error } = useCountryData(
    project.targetCountry,
    project.industry
  );

  if (loading) return <LoadingSpinner />;
  if (error) return <ErrorMessage error={error} />;
  if (!costFactor) return <EmptyState />;

  // ä½¿ç”¨costFactoræ•°æ®...
}
```

**æ‰¹é‡åŠ è½½ç¤ºä¾‹**:
```typescript
// Step 4åœºæ™¯å¯¹æ¯” - åŒæ—¶åŠ è½½å¤šå›½æ•°æ®
import { useCountryDataBatch } from '@/hooks/useCountryData';

const { data: countries, loading, errors } = useCountryDataBatch(
  ['US', 'DE', 'GB', 'JP', 'VN'],
  'pet_food'
);

console.log(`æˆåŠŸåŠ è½½: ${countries.length}/5å›½æ•°æ®`);
```

**ç†ç”±**:
- æ”¯æŒåŠ¨æ€åˆ‡æ¢å›½å®¶/è¡Œä¸šï¼ˆæ— éœ€ç¡¬ç¼–ç ï¼‰
- è‡ªåŠ¨å¤„ç†æ–‡ä»¶å¯¼å…¥å’Œé”™è¯¯
- æ”¯æŒLayer 2ï¼ˆæ ¸å¿ƒå­—æ®µï¼‰å’ŒLayer 3ï¼ˆæ‰©å±•å­—æ®µï¼‰æŒ‰éœ€åŠ è½½
- ç»Ÿä¸€çš„loading/errorçŠ¶æ€ç®¡ç†

---

### è§„èŒƒ4: æº¯æºå­—æ®µå‘½åçº¦å®šï¼ˆå‚è€ƒï¼‰

**å­—æ®µå‘½åè§„åˆ™**:
```typescript
// Baseå±‚æº¯æºå­—æ®µï¼ˆXX-base-data.tsï¼‰
m1_base_data_source: string     // é€šç”¨æ•°æ®æ¥æº
m1_base_tier: TierLevel         // é€šç”¨æ•°æ®è´¨é‡ï¼ˆtier1_official/tier2_authoritative/tier3_estimatedï¼‰
m1_base_collected_at: string    // é€šç”¨æ•°æ®é‡‡é›†æ—¶é—´ï¼ˆISO 8601æ ¼å¼ï¼‰

// Industryå±‚æº¯æºå­—æ®µï¼ˆXX-{industry}-specific.tsï¼‰
m1_industry_data_source: string // è¡Œä¸šç‰¹å®šæ¥æºï¼ˆè¦†ç›–baseå±‚ï¼‰
m1_tier: TierLevel              // æœ€ç»ˆè´¨é‡ï¼ˆä¼˜å…ˆçº§é«˜äºm1_base_tierï¼‰
m1_collected_at: string         // æœ€ç»ˆé‡‡é›†æ—¶é—´

// å­å­—æ®µç‰¹å®šæº¯æºï¼ˆç‰¹æ®Šæƒ…å†µï¼‰
m2_product_certification_data_source: string  // äº§å“è®¤è¯æ•°æ®æº
m2_trademark_data_source: string              // å•†æ ‡æ³¨å†Œæ•°æ®æº
m4_tariff_data_source: string                 // å…³ç¨æ•°æ®æº
m4_vat_data_source: string                    // VATæ•°æ®æº
m6_cac_data_source: string                    // CACæ•°æ®æº
m6_commission_data_source: string             // å¹³å°ä½£é‡‘æ•°æ®æº
```

**å‰ç«¯ä½¿ç”¨ç­–ç•¥**ï¼ˆä¼˜å…ˆçº§é“¾ï¼‰:
```typescript
// ä¼˜å…ˆä½¿ç”¨industryå±‚å­—æ®µï¼ˆæœ€æ–°ã€æœ€å‡†ç¡®ï¼‰
const dataSource = costFactor.m1_industry_data_source ||
                  costFactor.m1_base_data_source ||
                  'é»˜è®¤æ•°æ®æº';

const tier = costFactor.m1_tier ||
            costFactor.m1_base_tier ||
            'tier3_estimated';

// å­å­—æ®µä¼˜å…ˆçº§é“¾ï¼ˆModule 2ç¤ºä¾‹ï¼‰
const m2DataSource = costFactor.m2_product_certification_data_source ||
                    costFactor.m2_compliance_data_source ||
                    costFactor.m2_trademark_data_source ||
                    costFactor.m2_base_data_source ||
                    'M2ç»¼åˆæ•°æ®æº';

// Module 4ç¤ºä¾‹ï¼ˆå¤šä¸ªç¨è´¹å­å­—æ®µï¼‰
const m4DataSource = costFactor.m4_tariff_data_source ||
                    costFactor.m4_vat_data_source ||
                    costFactor.m4_logistics_data_source ||
                    costFactor.m4_base_data_source ||
                    'M4ç»¼åˆæ•°æ®æº';

// Module 6ç¤ºä¾‹ï¼ˆè¥é”€å­å­—æ®µï¼‰
const m6DataSource = costFactor.m6_commission_data_source ||
                    costFactor.m6_cac_data_source ||
                    costFactor.m6_marketing_data_source ||
                    'M6ç»¼åˆæ•°æ®æº';
```

**Mergedå±‚ç»Ÿä¸€å­—æ®µæ˜ å°„**ï¼ˆæ¨èå®è·µï¼‰:
```typescript
// åœ¨XX-{industry}.tsåˆå¹¶æ–‡ä»¶ä¸­åˆ›å»ºç»Ÿä¸€å­—æ®µ
export const VN_PET_FOOD: any = {
  ...VN_BASE_DATA,
  ...VN_PET_FOOD_SPECIFIC,

  // â­ ç»Ÿä¸€å­—æ®µæ˜ å°„ï¼ˆæ–¹ä¾¿å‰ç«¯ç›´æ¥ä½¿ç”¨ï¼‰
  m1_data_source: VN_PET_FOOD_SPECIFIC.m1_industry_data_source ||
                 VN_BASE_DATA.m1_base_data_source,

  m2_data_source: VN_PET_FOOD_SPECIFIC.m2_product_certification_data_source ||
                 VN_PET_FOOD_SPECIFIC.m2_compliance_data_source ||
                 VN_BASE_DATA.m2_base_data_source,

  // ... å…¶ä»–æ¨¡å—ç±»ä¼¼
};
```

---

## âš ï¸ ç¬¬3ç« ï¼šå¸¸è§é”™è¯¯æ¡ˆä¾‹ï¼ˆåæ¨¡å¼ + æ­£ç¡®åšæ³•ï¼‰

### åæ¨¡å¼1: æ‰‹åŠ¨é€‰æ‹©å­—æ®µå¤åˆ¶

**é”™è¯¯åœºæ™¯**:
```typescript
// âŒ è¯•å›¾"ç²¾ç®€"æ•°æ®ï¼Œåªä¿ç•™è®¡ç®—å¿…éœ€å­—æ®µ
const costFactor: Partial<CostFactor> = {
  country: 'VN',
  m1_estimated_cost_usd: 1450,  // åªè®¾ç½®æ€»è®¡
  m4_effective_tariff_rate: 0,
  m4_vat_rate: 0.1,
  m6_cac_usd: 18,
  m7_payment_rate: 0.029,
  // ç¼ºå¤±90%å­—æ®µ...
};
```

**é—®é¢˜åˆ†æ**:
1. UIæ˜¾ç¤ºæ˜ç»†å­—æ®µæ—¶è¿”å›undefined â†’ æ˜¾ç¤º0æˆ–ç©ºç™½
2. Tierå¾½ç« ç¼ºå°‘data_source â†’ æ˜¾ç¤º"æ•°æ®åº“é¢„è®¾"
3. æœªæ¥åŠŸèƒ½æ‰©å±•éœ€è¦æ–°å­—æ®µæ—¶ï¼Œå¿…é¡»ä¿®æ”¹æ‰€æœ‰æ•°æ®åŠ è½½é€»è¾‘
4. è¿åSSOTåŸåˆ™ï¼šæ•°æ®æ–‡ä»¶æ›´æ–°æ— æ³•è‡ªåŠ¨åŒæ­¥

**æ­£ç¡®åšæ³•**âœ…:
```typescript
// å®Œæ•´å¯¼å…¥ï¼Œä¿æŒSingle Source of Truth
import { VN_PET_FOOD } from '@/data/cost-factors/VN-pet-food';
const costFactor: CostFactor = { ...VN_PET_FOOD };
```

---

### åæ¨¡å¼2: åªå¯¼å…¥baseæ–‡ä»¶

**é”™è¯¯åœºæ™¯**:
```typescript
// âŒ åªå¯¼å…¥é€šç”¨å­—æ®µï¼Œç¼ºå¤±è¡Œä¸šç‰¹å®šæ•°æ®
import { VN_BASE_DATA } from '@/data/cost-factors/VN-base-data';
const costFactor = { ...VN_BASE_DATA };
// ç»“æœï¼šç¼ºå°‘55ä¸ªè¡Œä¸šç‰¹å®šå­—æ®µï¼ˆhs_code, cac, è¡Œä¸šè®¸å¯ç­‰ï¼‰
```

**é—®é¢˜åˆ†æ**:
1. ç¼ºå°‘m4_hs_code â†’ æ— æ³•å‡†ç¡®æŸ¥è¯¢å…³ç¨
2. ç¼ºå°‘m6_cac_usd â†’ æ— æ³•è®¡ç®—LTV:CAC
3. ç¼ºå°‘m1_industry_license_usd â†’ UIæ˜¾ç¤ºæˆæœ¬ä¸å®Œæ•´ï¼ˆå¦‚æ¡ˆä¾‹ä¸­çš„800 USDç¼ºå¤±ï¼‰
4. è¡Œä¸šåˆ‡æ¢ï¼ˆpet_food â†’ vapeï¼‰æ—¶ï¼Œé€šç”¨æ•°æ®ä¸é€‚ç”¨

**æ­£ç¡®åšæ³•**âœ…:
```typescript
// å¯¼å…¥å®Œæ•´mergedæ–‡ä»¶ï¼ˆbase + specificå·²è‡ªåŠ¨åˆå¹¶ï¼‰
import { VN_PET_FOOD } from '@/data/cost-factors/VN-pet-food';
// æˆ–
import { VN_VAPE } from '@/data/cost-factors/VN-vape';
```

---

### åæ¨¡å¼3: ç¼ºå¤±æº¯æºå­—æ®µ

**é”™è¯¯åœºæ™¯**:
```typescript
// âŒ åªå¤åˆ¶ä¸šåŠ¡å­—æ®µï¼Œå¿½ç•¥æº¯æºå­—æ®µ
const costFactor = {
  country: 'VN',
  m4_effective_tariff_rate: 0.10,
  m4_vat_rate: 0.10,
  // âŒ ç¼ºå°‘æº¯æºå­—æ®µï¼š
  // m4_tariff_data_source: æœªè®¾ç½®
  // m4_vat_data_source: æœªè®¾ç½®
  // m4_collected_at: æœªè®¾ç½®
  // m4_tier: æœªè®¾ç½®
};
```

**é—®é¢˜åˆ†æ**:
1. Tierå¾½ç« æ— æ³•æ˜¾ç¤ºæ•°æ®è´¨é‡ç­‰çº§
2. DataSourceTooltipæ˜¾ç¤º"æ•°æ®åº“é¢„è®¾"è€ŒéçœŸå®æ¥æº
3. æ— æ³•è¿½æº¯æ•°æ®æ›´æ–°æ—¶é—´ â†’ æ•°æ®è¿‡æœŸé£é™©
4. è¿åGECOMæ•°æ®è´¨é‡æ ‡å‡†ï¼ˆ100%æº¯æºè¦æ±‚ï¼‰

**æ­£ç¡®åšæ³•**âœ…:
```typescript
// å®Œæ•´å¯¼å…¥åŒ…å«æº¯æºå­—æ®µ
const costFactor: CostFactor = {
  ...VN_PET_FOOD,  // è‡ªåŠ¨åŒ…å«æ‰€æœ‰æº¯æºå­—æ®µ

  // å¦‚éœ€å­—æ®µæ˜ å°„ï¼Œç¡®ä¿åŒ…å«æº¯æºå­—æ®µ
  m4_data_source: (VN_PET_FOOD as any).m4_tariff_data_source ||
                 (VN_PET_FOOD as any).m4_vat_data_source ||
                 'è¶Šå—æµ·å…³æ€»ç½² + è´¢æ”¿éƒ¨VAT',
  m4_tier: VN_PET_FOOD.m4_tier || 'tier2_authoritative',
  m4_collected_at: VN_PET_FOOD.m4_collected_at || '2025-11-09',
};
```

---

## ğŸ’» ç¬¬4ç« ï¼šå®Œæ•´ä»£ç ç¤ºä¾‹

### ç¤ºä¾‹1: é™æ€å¯¼å…¥ï¼ˆå¼€å‘ç¯å¢ƒæ¨èï¼‰

**é€‚ç”¨åœºæ™¯**: Step 2æˆæœ¬å‚æ•°é…ç½®ï¼Œå›ºå®šå›½å®¶/è¡Œä¸š

```typescript
// components/wizard/Step2DataCollection.tsx
import { VN_PET_FOOD } from '@/data/cost-factors/VN-pet-food';
import { useState, useEffect } from 'react';
import { CostFactor, Project } from '@/types/gecom';

interface Props {
  project: Partial<Project>;
}

export default function Step2DataCollection({ project }: Props) {
  const [state, setState] = useState<{
    costFactor: CostFactor | null;
  }>({
    costFactor: null,
  });

  useEffect(() => {
    // âœ… å®Œæ•´spreadå¯¼å…¥
    const costFactor: CostFactor = {
      ...VN_PET_FOOD,  // 90+å­—æ®µå®Œæ•´å¯¼å…¥

      // å¯é€‰ï¼šè¦†ç›–åŠ¨æ€å­—æ®µ
      industry: project.industry as Industry || VN_PET_FOOD.industry,
      version: '2025Q1',

      // â­ å­—æ®µæ˜ å°„ï¼ˆå¦‚UIå­—æ®µåä¸æ•°æ®å­—æ®µåä¸åŒ¹é…ï¼‰
      m1_data_source: (VN_PET_FOOD as any).m1_industry_data_source ||
                     (VN_PET_FOOD as any).m1_base_data_source ||
                     'MARDå®˜ç½‘ + è¶Šå—è¿›å£ä»£ç†å…¬å¸æŠ¥ä»·',
      m2_data_source: (VN_PET_FOOD as any).m2_product_certification_data_source ||
                     (VN_PET_FOOD as any).m2_compliance_data_source ||
                     (VN_PET_FOOD as any).m2_trademark_data_source ||
                     'NAFIQADå®˜æ–¹æ”¶è´¹æ ‡å‡† + SGSè¶Šå—å®éªŒå®¤æŠ¥ä»·',
      m3_data_source: (VN_PET_FOOD as any).m3_base_data_source ||
                     'VNPost + J&T Expressè¶Šå—ä»“å‚¨æŠ¥ä»·',
      m4_data_source: (VN_PET_FOOD as any).m4_tariff_data_source ||
                     (VN_PET_FOOD as any).m4_vat_data_source ||
                     (VN_PET_FOOD as any).m4_logistics_data_source ||
                     'è¶Šå—æµ·å…³æ€»ç½² + è´¢æ”¿éƒ¨VAT',
      m5_data_source: (VN_PET_FOOD as any).m5_return_data_source ||
                     (VN_PET_FOOD as any).m5_data_source ||
                     'Shopeeè¶Šå—å–å®¶æ•°æ® + è¶Šå—ç”µå•†åä¼š',
      m6_data_source: (VN_PET_FOOD as any).m6_commission_data_source ||
                     (VN_PET_FOOD as any).m6_cac_data_source ||
                     (VN_PET_FOOD as any).m6_marketing_data_source ||
                     'Shopee Vietnamå®˜æ–¹è´¹ç‡ + Nielsen Vietnamè°ƒç ”',
      m7_data_source: (VN_PET_FOOD as any).m7_data_source ||
                     'VNPay/Momoæœ¬åœ°æ”¯ä»˜ç½‘å…³è´¹ç‡ + Shopeeæ”¯ä»˜',
      m8_data_source: (VN_PET_FOOD as any).m8_software_data_source ||
                     (VN_PET_FOOD as any).m8_cs_data_source ||
                     (VN_PET_FOOD as any).m8_data_source ||
                     'è¶Šå—ç”µå•†è¡Œä¸šäººåŠ›æˆæœ¬åŸºå‡†',

      // â­ å­—æ®µæ˜ å°„ï¼šè¡Œä¸šè®¸å¯è´¹
      m1_import_license_cost_usd: (VN_PET_FOOD as any).m1_industry_license_usd || 0,
      m1_import_license_required: (VN_PET_FOOD as any).m1_pre_approval_required || false,
    };

    setState(prev => ({ ...prev, costFactor }));
  }, [project.industry]);

  if (!state.costFactor) return <div>åŠ è½½ä¸­...</div>;

  return (
    <div>
      <h2>æˆæœ¬å‚æ•°é…ç½® - {state.costFactor.country_name_cn}</h2>
      {/* ä½¿ç”¨costFactoræ•°æ®æ¸²æŸ“UI */}
    </div>
  );
}
```

**ä¼˜ç‚¹**:
- âœ… TypeScriptç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
- âœ… çƒ­æ¨¡å—æ›¿æ¢ï¼ˆHMRï¼‰å¿«é€Ÿåˆ·æ–°
- âœ… æ— ç½‘ç»œè¯·æ±‚ï¼ŒåŠ è½½é€Ÿåº¦å¿«
- âœ… é€‚åˆå›ºå®šå›½å®¶/è¡Œä¸šåœºæ™¯

**ç¼ºç‚¹**:
- âŒ åˆ‡æ¢å›½å®¶éœ€è¦ä¿®æ”¹importè¯­å¥ï¼ˆä¸çµæ´»ï¼‰
- âŒ Bundle sizeè¾ƒå¤§ï¼ˆå¦‚æœå¯¼å…¥å¤šå›½æ•°æ®ï¼‰

---

### ç¤ºä¾‹2: åŠ¨æ€åŠ è½½ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

**é€‚ç”¨åœºæ™¯**: Step 0åˆ‡æ¢å›½å®¶/è¡Œä¸šï¼Œéœ€è¦è¿è¡Œæ—¶åŠ¨æ€åŠ è½½

```typescript
// lib/data-loader.ts
import { CostFactor, TargetCountry, Industry } from '@/types/gecom';

/**
 * åŠ¨æ€åŠ è½½æˆæœ¬å› å­æ•°æ®
 * @param country - å›½å®¶ä»£ç ï¼ˆUS/DE/VNç­‰ï¼‰
 * @param industry - è¡Œä¸šï¼ˆpet_food/vapeï¼‰
 * @param options - åŠ è½½é€‰é¡¹
 */
export async function loadCostFactor(
  country: TargetCountry,
  industry: Industry,
  options: {
    includeExtended?: boolean;  // æ˜¯å¦åŒ…å«Layer 3æ‰©å±•æ•°æ®
  } = {}
): Promise<CostFactor> {
  try {
    // Layer 1: åŠ¨æ€å¯¼å…¥TypeScriptæ–‡ä»¶ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
    const module = await import(`@/data/cost-factors/${country}-${industry}`);

    // æ”¯æŒå¤šç§å¯¼å‡ºæ ¼å¼
    const data = module[`${country.toUpperCase()}_${industry.toUpperCase()}`] ||
                module[`${country}_${industry}`] ||
                module.default;

    if (!data) {
      throw new Error(`æœªæ‰¾åˆ°${country}-${industry}æ•°æ®å¯¼å‡º`);
    }

    // Layer 2: å¦‚æœéœ€è¦æ‰©å±•æ•°æ®ï¼ŒåŠ è½½JSONæ–‡ä»¶
    if (options.includeExtended) {
      const extendedResponse = await fetch(
        `/data/${industry}-extended/${country}-${industry}-extended.json`
      );

      if (extendedResponse.ok) {
        const extendedData = await extendedResponse.json();
        return {
          ...data,
          extended: extendedData.extended,
        } as CostFactor;
      }
    }

    return data as CostFactor;
  } catch (error) {
    console.error(`åŠ è½½${country}-${industry}æ•°æ®å¤±è´¥:`, error);
    throw error;
  }
}
```

```typescript
// hooks/useCountryData.ts
import { useState, useEffect } from 'react';
import { loadCostFactor } from '@/lib/data-loader';
import { CostFactor, TargetCountry, Industry } from '@/types/gecom';

export function useCountryData(
  country: TargetCountry,
  industry: Industry,
  includeExtended: boolean = false
) {
  const [data, setData] = useState<CostFactor | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<Error | null>(null);

  useEffect(() => {
    const loadData = async () => {
      try {
        setLoading(true);
        setError(null);

        const costFactor = await loadCostFactor(
          country,
          industry,
          { includeExtended }
        );

        setData(costFactor);
      } catch (err) {
        setError(err as Error);
        console.error('æ•°æ®åŠ è½½å¤±è´¥:', err);
      } finally {
        setLoading(false);
      }
    };

    loadData();
  }, [country, industry, includeExtended]);

  const reload = async () => {
    await loadData();
  };

  return { data, loading, error, reload };
}
```

```typescript
// components/wizard/Step2DataCollection.tsx
import { useCountryData } from '@/hooks/useCountryData';

export default function Step2DataCollection({ project }: Props) {
  const { data: costFactor, loading, error } = useCountryData(
    project.targetCountry,  // æ¥è‡ªStep 0
    project.industry,       // æ¥è‡ªStep 0
    false  // ä¸éœ€è¦æ‰©å±•æ•°æ®ï¼ˆLayer 2ä»…æ ¸å¿ƒå­—æ®µï¼‰
  );

  if (loading) {
    return (
      <div className="flex items-center justify-center h-64">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600" />
        <span className="ml-3">åŠ è½½æ•°æ®ä¸­...</span>
      </div>
    );
  }

  if (error) {
    return (
      <div className="bg-red-50 border border-red-200 rounded-lg p-4">
        <h3 className="text-red-800 font-semibold">æ•°æ®åŠ è½½å¤±è´¥</h3>
        <p className="text-red-600 text-sm mt-1">{error.message}</p>
        <button
          onClick={() => window.location.reload()}
          className="mt-3 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
        >
          é‡æ–°åŠ è½½
        </button>
      </div>
    );
  }

  if (!costFactor) {
    return <div>æš‚æ— æ•°æ®</div>;
  }

  return (
    <div>
      <h2>æˆæœ¬å‚æ•°é…ç½® - {costFactor.country_name_cn}</h2>
      {/* ä½¿ç”¨costFactoræ•°æ®æ¸²æŸ“UI */}
    </div>
  );
}
```

**ä¼˜ç‚¹**:
- âœ… æ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢å›½å®¶/è¡Œä¸šï¼ˆçµæ´»ï¼‰
- âœ… æŒ‰éœ€åŠ è½½ï¼Œå‡å°‘åˆå§‹Bundle size
- âœ… ç»Ÿä¸€çš„loading/errorçŠ¶æ€ç®¡ç†
- âœ… æ”¯æŒLayer 2/3æŒ‰éœ€åŠ è½½

**ç¼ºç‚¹**:
- âŒ åŠ¨æ€å¯¼å…¥ç•¥æ…¢äºé™æ€å¯¼å…¥
- âŒ TypeScriptç±»å‹æ£€æŸ¥éœ€è¦é¢å¤–é…ç½®

---

### ç¤ºä¾‹3: æ‰¹é‡åŠ è½½ï¼ˆåœºæ™¯å¯¹æ¯”åŠŸèƒ½ï¼‰

**é€‚ç”¨åœºæ™¯**: Step 4åœºæ™¯å¯¹æ¯”ï¼ŒåŒæ—¶åŠ è½½å¤šå›½æ•°æ®

```typescript
// hooks/useCountryData.tsï¼ˆæ‰©å±•ï¼‰
export function useCountryDataBatch(
  countries: TargetCountry[],
  industry: Industry,
  includeExtended: boolean = false
) {
  const [data, setData] = useState<CostFactor[]>([]);
  const [loading, setLoading] = useState(true);
  const [errors, setErrors] = useState<Record<string, Error>>({});

  useEffect(() => {
    const loadAllData = async () => {
      try {
        setLoading(true);
        const results: CostFactor[] = [];
        const errorMap: Record<string, Error> = {};

        // å¹¶è¡ŒåŠ è½½æ‰€æœ‰å›½å®¶æ•°æ®
        await Promise.allSettled(
          countries.map(async (country) => {
            try {
              const costFactor = await loadCostFactor(
                country,
                industry,
                { includeExtended }
              );
              results.push(costFactor);
            } catch (err) {
              errorMap[country] = err as Error;
              console.error(`åŠ è½½${country}æ•°æ®å¤±è´¥:`, err);
            }
          })
        );

        setData(results);
        setErrors(errorMap);
      } finally {
        setLoading(false);
      }
    };

    loadAllData();
  }, [countries.join(','), industry, includeExtended]);

  return {
    data,
    loading,
    errors,
    successCount: data.length,
    failureCount: Object.keys(errors).length,
  };
}
```

```typescript
// components/wizard/Step4Comparison.tsx
import { useCountryDataBatch } from '@/hooks/useCountryData';

export default function Step4Comparison({ project }: Props) {
  const compareCountries: TargetCountry[] = ['US', 'DE', 'GB', 'JP', 'VN'];

  const {
    data: countries,
    loading,
    errors,
    successCount,
    failureCount,
  } = useCountryDataBatch(
    compareCountries,
    project.industry,
    false  // Layer 2æ ¸å¿ƒæ•°æ®è¶³å¤Ÿå¯¹æ¯”
  );

  if (loading) {
    return (
      <div className="text-center">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto" />
        <p className="mt-3 text-gray-600">
          æ­£åœ¨åŠ è½½{compareCountries.length}ä¸ªå›½å®¶çš„æ•°æ®...
        </p>
      </div>
    );
  }

  return (
    <div>
      <h2>åœºæ™¯å¯¹æ¯”åˆ†æ</h2>
      <p className="text-sm text-gray-600 mb-4">
        æˆåŠŸåŠ è½½: {successCount}/{compareCountries.length}å›½æ•°æ®
        {failureCount > 0 && (
          <span className="text-red-600"> | å¤±è´¥: {failureCount}å›½</span>
        )}
      </p>

      {/* å¯¹æ¯”è¡¨æ ¼ */}
      <table className="w-full border">
        <thead>
          <tr>
            <th>å›½å®¶</th>
            <th>å…³ç¨ç‡</th>
            <th>VATç‡</th>
            <th>æ¯›åˆ©ç‡</th>
            <th>ROI</th>
          </tr>
        </thead>
        <tbody>
          {countries.map((country) => (
            <tr key={country.country}>
              <td>{country.country_name_cn}</td>
              <td>{(country.m4_effective_tariff_rate * 100).toFixed(1)}%</td>
              <td>{(country.m4_vat_rate * 100).toFixed(1)}%</td>
              <td>{/* è®¡ç®—æ¯›åˆ©ç‡... */}</td>
              <td>{/* è®¡ç®—ROI... */}</td>
            </tr>
          ))}
        </tbody>
      </table>

      {/* é”™è¯¯æç¤º */}
      {Object.keys(errors).length > 0 && (
        <div className="mt-4 bg-yellow-50 border border-yellow-200 rounded p-3">
          <h4 className="text-yellow-800 font-semibold">éƒ¨åˆ†æ•°æ®åŠ è½½å¤±è´¥</h4>
          <ul className="text-sm text-yellow-700 mt-1">
            {Object.entries(errors).map(([country, error]) => (
              <li key={country}>
                {country}: {error.message}
              </li>
            ))}
          </ul>
        </div>
      )}
    </div>
  );
}
```

---

## ğŸ“‹ ç¬¬5ç« ï¼šå­—æ®µå‘½åçº¦å®šå‚è€ƒè¡¨

### Module 1 (M1): å¸‚åœºå‡†å…¥

| å­—æ®µç”¨é€” | Baseå±‚å­—æ®µå | Industryå±‚å­—æ®µå | UIæœŸæœ›å­—æ®µå | ä¼˜å…ˆçº§é“¾ |
|---------|-------------|-----------------|-------------|---------|
| å…¬å¸æ³¨å†Œè´¹ | m1_company_registration_usd | - | m1_company_registration_usd | ç›´æ¥ä½¿ç”¨ |
| è¥ä¸šæ‰§ç…§è´¹ | m1_business_license_usd | - | m1_business_license_usd | ç›´æ¥ä½¿ç”¨ |
| ç¨åŠ¡ç™»è®°è´¹ | m1_tax_registration_usd | - | m1_tax_registration_usd | ç›´æ¥ä½¿ç”¨ |
| æ³•åŠ¡å’¨è¯¢è´¹ | m1_legal_consulting_usd | - | m1_legal_consulting_usd | ç›´æ¥ä½¿ç”¨ |
| è¡Œä¸šè®¸å¯è´¹ | - | m1_industry_license_usd | m1_import_license_cost_usd | éœ€æ˜ å°„âš ï¸ |
| æ•°æ®æ¥æº | m1_base_data_source | m1_industry_data_source | m1_data_source | industry > base |
| æ•°æ®è´¨é‡ | m1_base_tier | m1_tier | m1_tier | industry > base |
| é‡‡é›†æ—¶é—´ | m1_base_collected_at | m1_collected_at | m1_collected_at | industry > base |

### Module 2 (M2): æŠ€æœ¯åˆè§„

| å­—æ®µç”¨é€” | Baseå±‚å­—æ®µå | Industryå±‚å­—æ®µå | UIæœŸæœ›å­—æ®µå | ä¼˜å…ˆçº§é“¾ |
|---------|-------------|-----------------|-------------|---------|
| äº§å“è®¤è¯è´¹ | - | m2_product_certification_usd | m2_product_certification_usd | ç›´æ¥ä½¿ç”¨ |
| åˆè§„æ£€æµ‹è´¹ | - | m2_compliance_testing_usd | m2_compliance_testing_usd | ç›´æ¥ä½¿ç”¨ |
| å•†æ ‡æ³¨å†Œè´¹ | m2_trademark_registration_usd | - | m2_trademark_registration_usd | ç›´æ¥ä½¿ç”¨ |
| æ•°æ®æ¥æº | m2_base_data_source | m2_product_certification_data_source<br>m2_compliance_data_source<br>m2_trademark_data_source | m2_data_source | product_cert > compliance > trademark > base |

### Module 4 (M4): è´§ç‰©ç¨è´¹ï¼ˆå­å­—æ®µæœ€å¤šï¼‰

| å­—æ®µç”¨é€” | Baseå±‚å­—æ®µå | Industryå±‚å­—æ®µå | UIæœŸæœ›å­—æ®µå | ä¼˜å…ˆçº§é“¾ |
|---------|-------------|-----------------|-------------|---------|
| å…³ç¨ç‡ | m4_effective_tariff_rate | - | m4_effective_tariff_rate | ç›´æ¥ä½¿ç”¨ |
| VATç‡ | m4_vat_rate | - | m4_vat_rate | ç›´æ¥ä½¿ç”¨ |
| ç‰©æµæˆæœ¬ | m4_logistics | - | m4_logistics | ç›´æ¥ä½¿ç”¨ |
| HSç¼–ç  | - | m4_hs_code | m4_hs_code | ç›´æ¥ä½¿ç”¨ï¼ˆä»…specificï¼‰ |
| å…³ç¨æ•°æ®æº | - | m4_tariff_data_source | m4_data_source | tariff > vat > logistics > base |
| VATæ•°æ®æº | - | m4_vat_data_source | - | å­å­—æ®µç‹¬ç«‹ |
| ç‰©æµæ•°æ®æº | - | m4_logistics_data_source | - | å­å­—æ®µç‹¬ç«‹ |

### Module 6 (M6): è¥é”€è·å®¢

| å­—æ®µç”¨é€” | Baseå±‚å­—æ®µå | Industryå±‚å­—æ®µå | UIæœŸæœ›å­—æ®µå | ä¼˜å…ˆçº§é“¾ |
|---------|-------------|-----------------|-------------|---------|
| CAC | - | m6_cac_usd | m6_cac_usd | ç›´æ¥ä½¿ç”¨ |
| å¹³å°ä½£é‡‘ç‡ | - | m6_platform_commission_rate | m6_platform_commission_rate | ç›´æ¥ä½¿ç”¨ |
| CACæ•°æ®æº | - | m6_cac_data_source | m6_data_source | cac > commission > marketing |
| ä½£é‡‘æ•°æ®æº | - | m6_commission_data_source | - | å­å­—æ®µç‹¬ç«‹ |
| è¥é”€æ•°æ®æº | - | m6_marketing_data_source | - | å­å­—æ®µç‹¬ç«‹ |

### Module 5/7/8: ç®€åŒ–å‘½åæ¨¡å—

| æ¨¡å— | Baseå±‚å­—æ®µå | Industryå±‚å­—æ®µå | UIæœŸæœ›å­—æ®µå | ä¼˜å…ˆçº§é“¾ |
|------|-------------|-----------------|-------------|---------|
| M5ç‰©æµé…é€ | m5_data_source | m5_return_data_source | m5_data_source | return > base |
| M7æ”¯ä»˜æ‰‹ç»­è´¹ | m7_data_source | - | m7_data_source | ç›´æ¥ä½¿ç”¨ |
| M8è¿è¥ç®¡ç† | m8_data_source | m8_software_data_source<br>m8_cs_data_source | m8_data_source | software > cs > base |

---

## âœ… ç¬¬6ç« ï¼šéªŒæ”¶æ¸…å•

åœ¨å®æ–½æ•°æ®å¯¼å…¥é€»è¾‘åï¼Œå¿…é¡»é€šè¿‡ä»¥ä¸‹éªŒæ”¶æ¸…å•ï¼š

### ä»£ç è´¨é‡éªŒæ”¶
- [ ] TypeScriptç¼–è¯‘é€šè¿‡ï¼ˆ0é”™è¯¯ï¼‰
- [ ] ä½¿ç”¨å®Œæ•´spreadå¯¼å…¥ï¼ˆ...VN_PET_FOODï¼‰è€Œéæ‰‹åŠ¨é€‰æ‹©å­—æ®µ
- [ ] å¯¼å…¥mergedæ–‡ä»¶è€Œébaseæ–‡ä»¶
- [ ] å­—æ®µæ˜ å°„é€»è¾‘æ­£ç¡®ï¼ˆå¦‚æœ‰ï¼‰

### æ•°æ®å®Œæ•´æ€§éªŒæ”¶
- [ ] UIæ˜¾ç¤ºæ‰€æœ‰æˆæœ¬æ˜ç»†å­—æ®µï¼ˆæ— 0æˆ–undefinedï¼‰
- [ ] M1-M8æ€»è®¡ä¸æ˜ç»†åŒ¹é…ï¼ˆå¦‚M1: 300+150+0+1000+800=2250æˆ–2000ï¼‰
- [ ] è¡Œä¸šç‰¹å®šå­—æ®µæ­£ç¡®æ˜¾ç¤ºï¼ˆå¦‚m1_industry_license_usd â†’ m1_import_license_cost_usdï¼‰
- [ ] æ‰©å±•å­—æ®µå¯è®¿é—®ï¼ˆå¦‚data_quality_summaryï¼‰

### æ•°æ®æº¯æºéªŒæ”¶
- [ ] æ‰€æœ‰æ¨¡å—Tierå¾½ç« æ˜¾ç¤ºçœŸå®æ•°æ®æºï¼ˆé"æ•°æ®åº“é¢„è®¾"ï¼‰
- [ ] DataSourceTooltipæ˜¾ç¤ºå®Œæ•´æº¯æºä¿¡æ¯ï¼ˆæ¥æº+è´¨é‡+æ—¶é—´ï¼‰
- [ ] ä¼˜å…ˆçº§é“¾é€»è¾‘æ­£ç¡®ï¼ˆindustry > base > fallbackï¼‰
- [ ] å­å­—æ®µæ•°æ®æºæ˜ å°„æ­£ç¡®ï¼ˆå¦‚m4_tariff_data_source, m6_cac_data_sourceï¼‰

### æ€§èƒ½éªŒæ”¶
- [ ] é™æ€å¯¼å…¥ï¼šHMRåˆ·æ–°<1ç§’
- [ ] åŠ¨æ€å¯¼å…¥ï¼šé¦–æ¬¡åŠ è½½<2ç§’
- [ ] æ‰¹é‡åŠ è½½ï¼š5å›½å¹¶è¡Œ<5ç§’
- [ ] æ— å†…å­˜æ³„æ¼ï¼ˆuseEffect cleanupæ­£ç¡®ï¼‰

### å¯ç»´æŠ¤æ€§éªŒæ”¶
- [ ] æ•°æ®æ–‡ä»¶æ›´æ–°è‡ªåŠ¨åŒæ­¥ï¼ˆæ— éœ€ä¿®æ”¹ç»„ä»¶ä»£ç ï¼‰
- [ ] æ–°å¢å›½å®¶/è¡Œä¸šä»…éœ€æ·»åŠ æ•°æ®æ–‡ä»¶ï¼ˆæ— éœ€ä¿®æ”¹å¯¼å…¥é€»è¾‘ï¼‰
- [ ] å­—æ®µå‘½åçº¦å®šæ–‡æ¡£åŒ–ï¼ˆæœ¬è§„èŒƒç¬¬5ç« ï¼‰
- [ ] é”™è¯¯å¤„ç†å®Œå–„ï¼ˆloading/errorçŠ¶æ€ï¼‰

---

## ğŸ”— é™„å½•ï¼šç›¸å…³æ–‡æ¡£ç´¢å¼•

**åˆ†ææ–‡æ¡£ï¼ˆç¬¬2å±‚ï¼‰**:
- [DATA-LOADING-ROOT-CAUSE-ANALYSIS-2025-11-13.md](./DATA-LOADING-ROOT-CAUSE-ANALYSIS-2025-11-13.md) - æœ¬è§„èŒƒçš„é—®é¢˜æ ¹å› åˆ†æ
- [ULTRA-THINK-ANALYSIS-2025-11-13.md](./ULTRA-THINK-ANALYSIS-2025-11-13.md) - æ·±åº¦æŠ€æœ¯è°ƒç ”

**ä»»åŠ¡æ¸…å•ï¼ˆç¬¬1å±‚SSOTï¼‰**:
- [MVP-2.0-ä»»åŠ¡æ¸…å•.md](./MVP-2.0-ä»»åŠ¡æ¸…å•.md) - Day 20+ Phase 1-3ä»»åŠ¡è¿½è¸ª

**å…¶ä»–è§„èŒƒæ–‡æ¡£ï¼ˆç¬¬3å±‚ï¼‰**:
- [DATA-COLLECTION-STANDARD.md](./DATA-COLLECTION-STANDARD.md) - æ•°æ®é‡‡é›†æ ‡å‡†ä¸è§„èŒƒ
- [DATA-TEMPLATE-EXAMPLE.md](./templates/DATA-TEMPLATE-EXAMPLE.md) - æ•°æ®æ¨¡æ¿ç¤ºä¾‹

**é¡¹ç›®æ–‡æ¡£**:
- [CLAUDE.md](../CLAUDE.md) - é¡¹ç›®æ€»è§ˆä¸å¼€å‘è§„èŒƒ

---

## ğŸ“ å˜æ›´æ—¥å¿—

**v1.0 (2025-11-13)**:
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- å®Œæ•´4ä¸ªæ ¸å¿ƒè§„èŒƒï¼ˆå¼ºåˆ¶2ä¸ª + æ¨è2ä¸ªï¼‰
- 3ä¸ªåæ¨¡å¼æ¡ˆä¾‹ + æ­£ç¡®åšæ³•å¯¹æ¯”
- 3ä¸ªå®Œæ•´ä»£ç ç¤ºä¾‹ï¼ˆé™æ€/åŠ¨æ€/æ‰¹é‡ï¼‰
- 5ç« å­—æ®µå‘½åçº¦å®šå‚è€ƒè¡¨
- å®Œæ•´éªŒæ”¶æ¸…å•

---

**æ–‡æ¡£ç»´æŠ¤è€…**: GECOM Team
**å®¡æ ¸çŠ¶æ€**: âœ… å·²å®¡æ ¸ï¼ˆv2.0åŸºäº2025-11-14å®é™…bugä¿®å¤ç»éªŒï¼‰
**ä¸‹æ¬¡æ›´æ–°**: æ ¹æ®å®é™…ä½¿ç”¨åé¦ˆä¼˜åŒ–ï¼ˆé¢„è®¡2025-Q2ï¼‰

---

## ğŸ”§ ç¬¬7ç« ï¼šä»£ç ç¼–å†™è§„èŒƒï¼ˆv2.0æ–°å¢ - åŸºäº2025-11-14ä¿®å¤ç»éªŒï¼‰

> **æ–°å¢èƒŒæ™¯**ï¼š2025-11-14å‘ç°å¹¶ä¿®å¤äº†ä¸¤å¤§ç³»ç»Ÿæ€§é—®é¢˜ï¼š
> 1. **34ä¸ªå­—æ®µæ˜ å°„ç¼ºå¤±**å¯¼è‡´æ•°æ®æ˜¾ç¤ºä¸º0
> 2. **28ä¸ªæ¡ä»¶æ¸²æŸ“bug**å¯¼è‡´spurious "0"å­—ç¬¦æ˜¾ç¤º
>
> æœ¬ç« æ€»ç»“äº†è¿™æ¬¡ä¿®å¤çš„æ ¸å¿ƒç»éªŒï¼Œå½¢æˆå¼ºåˆ¶æ€§ä»£ç ç¼–å†™è§„èŒƒã€‚
> è¯¦è§ï¼š[SESSION-SUMMARY-2025-11-14-M1-M8-DATA-FIX.md](./SESSION-SUMMARY-2025-11-14-M1-M8-DATA-FIX.md)

### è§„èŒƒC1: æ¡ä»¶æ¸²æŸ“å¿…é¡»ç±»å‹å®‰å…¨ ğŸ”´ å¼ºåˆ¶

**é—®é¢˜æ ¹å› **ï¼šReactçš„ `{value && <Component />}` åœ¨valueä¸º0æ—¶æ¸²æŸ“"0"å­—ç¬¦ä¸²ï¼ˆ2025-11-14å‘ç°28ä¸ªæ­¤ç±»bugï¼‰

**å¼ºåˆ¶è§„åˆ™**ï¼š
- âœ… **æ•°å€¼å­—æ®µ**å¿…é¡»ä½¿ç”¨ï¼š`{(value ?? 0) > 0 && <Component />}`
- âœ… **å¸ƒå°”å­—æ®µ**å¿…é¡»ä½¿ç”¨ï¼š`{!!value && <Component />}`
- âœ… **å­—ç¬¦ä¸²å­—æ®µ**å¿…é¡»ä½¿ç”¨ï¼š`{!!value && <Component />}` æˆ– `{value?.length > 0 && <Component />}`
- âŒ **ç¦æ­¢**ï¼šæ•°å€¼å­—æ®µç›´æ¥ä½¿ç”¨ `{value && <Component />}`

**æ­£ç¡®ç¤ºä¾‹**ï¼š
```typescript
// âœ… æ­£ç¡®ï¼šæ•°å€¼å­—æ®µï¼ˆFBAè´¹ç”¨ï¼‰
{(getEffectiveValue('m5_fba_fee_small_usd') ?? 0) > 0 && (
  <CostItemRow
    label="FBAå°ä»¶è´¹ç”¨"
    value={getEffectiveValue('m5_fba_fee_small_usd')}
    unit="USD"
  />
)}
// è¡Œä¸ºï¼švalue = 0 â†’ ä¸æ¸²æŸ“ âœ… | value = 10 â†’ æ¸²æŸ“ç»„ä»¶ âœ… | value = undefined â†’ ä¸æ¸²æŸ“ âœ…

// âœ… æ­£ç¡®ï¼šå¸ƒå°”å­—æ®µï¼ˆè¿›å£è®¸å¯ï¼‰
{!!getEffectiveValue('m1_import_license_required') && (
  <div className="bg-yellow-50 p-4">
    <p>éœ€è¦è¿›å£è®¸å¯è¯</p>
  </div>
)}
// è¡Œä¸ºï¼švalue = false â†’ ä¸æ¸²æŸ“ âœ… | value = true â†’ æ¸²æŸ“ç»„ä»¶ âœ…

// âœ… æ­£ç¡®ï¼šå­—ç¬¦ä¸²å­—æ®µï¼ˆVATå¤‡æ³¨ï¼‰
{!!getEffectiveValue('m4_vat_notes') && (
  <div className="text-sm text-gray-600">
    {getEffectiveValue('m4_vat_notes')}
  </div>
)}
```

**é”™è¯¯ç¤ºä¾‹**ï¼š
```typescript
// âŒ é”™è¯¯ï¼šæ•°å€¼å­—æ®µç›´æ¥ç”¨ &&
{getEffectiveValue('m5_fba_fee_small_usd') && (
  <CostItemRow label="FBAå°ä»¶è´¹ç”¨" ... />
)}
// é—®é¢˜ï¼švalue = 0æ—¶æ¸²æŸ“å­—ç¬¦ä¸²"0"ï¼Œè€Œéä¸æ¸²æŸ“ âš ï¸

// âŒ é”™è¯¯ï¼šä½¿ç”¨ || è€Œé ??
{(getEffectiveValue('m5_fba_fee_small_usd') || 0) > 0 && ...}
// é—®é¢˜ï¼š|| ä¼šå°†0è¯¯åˆ¤ä¸ºfalsyï¼ˆè™½ç„¶ç»“æœç›¸åŒï¼Œä½†é€»è¾‘ä¸æ¸…æ™°ï¼‰
```

**éªŒæ”¶å‘½ä»¤**ï¼š
```bash
# æŸ¥æ‰¾å¯èƒ½çš„é—®é¢˜ä»£ç 
grep -n "getEffectiveValue.*) &&" components/wizard/Step2DataCollection.tsx | grep -v "??" | grep -v "!!"

# æŸ¥æ‰¾æ­£ç¡®çš„æ¨¡å¼
grep -n "(.*?? 0) > 0 &&" components/wizard/Step2DataCollection.tsx
```

---

### è§„èŒƒC2: ä½¿ç”¨Nullish Coalescing (??) è€ŒéLogical OR (||) ğŸŸ¡ æ¨è

**æ¨èåŸå› **ï¼š`??` åªå¤„ç†null/undefinedï¼Œä¿ç•™0ã€falseã€ç©ºå­—ç¬¦ä¸²ç­‰åˆæ³•falsyå€¼

**æ¨èåœºæ™¯**ï¼š
- âœ… **æ•°å€¼å­—æ®µ**ï¼šä¼˜å…ˆä½¿ç”¨ `??`ï¼ˆé¿å…0è¢«è¯¯åˆ¤ï¼‰
- âœ… **è®¡ç®—fallback**ï¼šä½¿ç”¨ `??`ï¼ˆä¿ç•™0å€¼ï¼‰
- ğŸŸ¢ **å­—ç¬¦ä¸²å­—æ®µ**ï¼š`??` å’Œ `||` æ•ˆæœç›¸åŒï¼ˆç©ºå­—ç¬¦ä¸²æ˜¯åˆæ³•falsyï¼‰
- ğŸŸ¢ **å¸ƒå°”å­—æ®µ**ï¼šå¿…é¡»ç”¨ `??` æˆ–æ˜¾å¼æ£€æŸ¥

**æ­£ç¡®ç¤ºä¾‹**ï¼š
```typescript
// âœ… æ¨èï¼šæ•°å€¼å­—æ®µç”¨ ??
const fbaFee = (costFactor.m5_fba_fee_usd ?? 0);
// è¡Œä¸ºï¼švalue = 0 â†’ è¿”å›0 âœ… | value = null â†’ è¿”å›0 | value = undefined â†’ è¿”å›0

// âœ… æ¨èï¼šå­—æ®µæ˜ å°„ä¼˜å…ˆçº§é“¾
m2_product_testing_cost_usd:
  (VN_PET_FOOD as any).m2_product_certification_usd ??  // è¡Œä¸šç‰¹å®š
  (VN_PET_FOOD as any).m2_compliance_testing_usd ??     // é€šç”¨æ•°æ®
  0,  // é»˜è®¤å€¼

// âœ… æ¨èï¼šå¸ƒå°”å­—æ®µç”¨ ??
const required = data.m1_import_license_required ?? false;
```

**ä¸æ¨èç¤ºä¾‹**ï¼š
```typescript
// âŒ ä¸æ¨èï¼šæ•°å€¼å­—æ®µç”¨ ||
const fbaFee = (costFactor.m5_fba_fee_usd || 0);
// è¡Œä¸ºï¼švalue = 0 â†’ è¿”å›0ï¼ˆä½†é€»è¾‘ä¸Š0è¢«å½“ä½œfalsyå¤„ç†ï¼Œè¯­ä¹‰ä¸æ¸…ï¼‰âš ï¸

// âŒ ä¸æ¨èï¼šå¸ƒå°”å­—æ®µç”¨ ||
const required = data.m1_import_license_required || false;
// é—®é¢˜ï¼šfalseè¢«å½“ä½œfalsyï¼Œè¿”å›falseï¼ˆé€»è¾‘æ··ä¹±ï¼‰
```

**ä¾‹å¤–åœºæ™¯**ï¼š
```typescript
// å­—ç¬¦ä¸²å­—æ®µï¼š|| å’Œ ?? æ•ˆæœç›¸åŒï¼ˆç©ºå­—ç¬¦ä¸²æ˜¯åˆæ³•falsyï¼‰
const notes = data.m4_vat_notes || 'æ— å¤‡æ³¨';  // âœ… å¯æ¥å—
const notes2 = data.m4_vat_notes ?? 'æ— å¤‡æ³¨';  // âœ… æ¨èï¼ˆè¯­ä¹‰æ›´æ¸…æ™°ï¼‰
```

---

### è§„èŒƒC3: å­—æ®µæ˜ å°„ä¼˜å…ˆçº§é“¾å¿…é¡»æ˜ç¡® ğŸ”´ å¼ºåˆ¶

**é—®é¢˜æ ¹å› **ï¼š34ä¸ªå­—æ®µå› UIå­—æ®µåä¸æ•°æ®å­—æ®µåä¸åŒ¹é…å¯¼è‡´æ˜¾ç¤º0ï¼ˆ2025-11-14ä¿®å¤ï¼‰

**å¼ºåˆ¶è§„åˆ™**ï¼š
- âœ… **å¿…é¡»**ï¼šä¼˜å…ˆçº§é¡ºåºæ˜ç¡®æ ‡æ³¨ï¼ˆè¡Œä¸šç‰¹å®š > å›½å®¶é€šç”¨ > é»˜è®¤å€¼ï¼‰
- âœ… **å¿…é¡»**ï¼šæœ€åä¸€çº§æ˜¯é»˜è®¤å€¼ï¼ˆ0ã€''ã€falseç­‰ï¼‰
- âœ… **å¿…é¡»**ï¼šä½¿ç”¨ `??` è€Œé `||` å¤„ç†æ•°å€¼å­—æ®µ
- âŒ **ç¦æ­¢**ï¼šéšå¼ä¾èµ–spreadé¡ºåºå†³å®šä¼˜å…ˆçº§

**æ­£ç¡®ç¤ºä¾‹**ï¼š
```typescript
// âœ… æ­£ç¡®ï¼šä¸‰çº§ä¼˜å…ˆçº§é“¾
const costFactor: CostFactor = {
  ...VN_PET_FOOD,  // å®Œæ•´spreadå¯¼å…¥

  // æ˜ç¡®ä¼˜å…ˆçº§é“¾ï¼šspecific > base > default
  m2_product_testing_cost_usd:
    (VN_PET_FOOD as any).m2_product_certification_usd ??  // Level 1: è¡Œä¸šç‰¹å®šï¼ˆ1200 USDï¼‰
    (VN_PET_FOOD as any).m2_compliance_testing_usd ??     // Level 2: å›½å®¶é€šç”¨ï¼ˆ800 USDï¼‰
    0,                                                     // Level 3: é»˜è®¤å€¼

  // è®¡ç®—å­—æ®µï¼šæ˜ç¡®æ•°æ®æ¥æº
  m3_total_estimated_usd:
    ((VN_PET_FOOD as any).m3_initial_inventory_usd ?? 0) +      // VN_PET_FOOD_SPECIFIC
    ((VN_PET_FOOD as any).m3_warehouse_deposit_usd ?? 0) +      // VN_BASE_DATA
    ((VN_PET_FOOD as any).m3_system_setup_usd ?? 0),            // VN_BASE_DATA

  // æº¯æºå­—æ®µä¼˜å…ˆçº§é“¾
  m1_data_source:
    (VN_PET_FOOD as any).m1_industry_data_source ??
    (VN_PET_FOOD as any).m1_base_data_source ??
    'MARDå®˜ç½‘ + è¶Šå—è¿›å£ä»£ç†å…¬å¸æŠ¥ä»·',
};
```

**é”™è¯¯ç¤ºä¾‹**ï¼š
```typescript
// âŒ é”™è¯¯ï¼šç¼ºå°‘fallbacké»˜è®¤å€¼
m2_product_testing_cost_usd:
  (VN_PET_FOOD as any).m2_product_certification_usd ??
  (VN_PET_FOOD as any).m2_compliance_testing_usd;
  // ç¼ºå°‘ ?? 0ï¼Œå¯èƒ½è¿”å›undefined âš ï¸

// âŒ é”™è¯¯ï¼šä½¿ç”¨ || å¤„ç†æ•°å€¼
m5_fba_fee_small_usd:
  (VN_PET_FOOD as any).m5_fba_fee_usd || 0;
  // å¦‚æœm5_fba_fee_usd = 0ï¼ˆåˆæ³•å€¼ï¼‰ï¼Œä¼šé”™è¯¯fallbackåˆ°0
  // åº”ä½¿ç”¨ ?? 0
```

---

### è§„èŒƒC4: TypeScriptç±»å‹æ–­è¨€æ˜ç¡®æ ‡æ³¨ ğŸŸ¡ æ¨è

**æ¨èåŸå› **ï¼šæå‡ä»£ç å¯è¯»æ€§ï¼Œæ˜ç¡®å‘ŠçŸ¥æ˜¯intentionalçš„ç±»å‹ç»•è¿‡

**æ¨èåšæ³•**ï¼š
```typescript
// âœ… æ¨èï¼šæ˜¾å¼ as any æ–­è¨€
const value = (VN_PET_FOOD as any).m2_product_certification_usd ?? 0;

// âœ… æ›´æ¨èï¼šå®Œæ•´ç±»å‹å®šä¹‰ï¼ˆå¦‚æœ‰æ—¶é—´ï¼‰
interface PetFoodCostFactor extends CostFactor {
  m2_product_certification_usd?: number;
  m2_compliance_testing_usd?: number;
}
const data = VN_PET_FOOD as PetFoodCostFactor;
const value = data.m2_product_certification_usd ?? 0;
```

**ä¸æ¨èåšæ³•**ï¼š
```typescript
// âŒ ä¸æ¨èï¼šéšå¼anyï¼ˆTypeScript strictæ¨¡å¼ä¼šæŠ¥é”™ï¼‰
const value = VN_PET_FOOD.m2_product_certification_usd ?? 0;
// Error: Property 'm2_product_certification_usd' does not exist on type 'CostFactor'
```

---

### è§„èŒƒC5: å­—æ®µåˆ†ç»„æ³¨é‡Šæ¸…æ™° ğŸŸ¡ æ¨è

**æ¨èåŸå› **ï¼šæå‡ä»£ç å¯ç»´æŠ¤æ€§ï¼Œå¿«é€Ÿå®šä½å­—æ®µæ‰€å±æ¨¡å—ï¼ˆæœ¬æ¬¡ä¿®å¤æ¶‰åŠM1-M8å…±62ä¸ªå­—æ®µï¼‰

**æ¨èåšæ³•**ï¼š
```typescript
const costFactor: CostFactor = {
  ...VN_PET_FOOD,

  // ========== M1 å¸‚åœºå‡†å…¥ ==========
  m1_data_source: (VN_PET_FOOD as any).m1_industry_data_source ?? ...,
  m1_import_license_cost_usd: (VN_PET_FOOD as any).m1_industry_license_usd ?? 0,

  // ========== M2 æŠ€æœ¯åˆè§„ ==========
  m2_data_source: (VN_PET_FOOD as any).m2_product_certification_data_source ?? ...,
  m2_product_testing_cost_usd:
    (VN_PET_FOOD as any).m2_product_certification_usd ??  // VN_PET_FOOD_SPECIFIC: 1200 USD
    (VN_PET_FOOD as any).m2_compliance_testing_usd ??     // VN_BASE_DATA: 800 USD
    0,  // é»˜è®¤å€¼ï¼ˆæ•°æ®ä¸å­˜åœ¨æ—¶ï¼‰

  // ========== M3-M8 åŒç† ==========
};
```

---

## ğŸ“ ç¬¬8ç« ï¼šæ–‡æ¡£ç®¡ç†3å±‚è§„åˆ™ï¼ˆv2.0æ–°å¢ï¼‰

### è§„åˆ™D1: é¡¹ç›®æ–‡æ¡£å±‚ï¼ˆdocs/ï¼‰

**é€‚ç”¨èŒƒå›´**ï¼šå½“å‰é¡¹ç›®ä½¿ç”¨çš„æ‰€æœ‰è§„èŒƒã€åˆ†æã€ç®¡ç†æ–‡æ¡£

**ä¿ç•™è§„åˆ™**ï¼š
- âœ… ä¿ç•™æ‰€æœ‰å½“å‰ç‰ˆæœ¬çš„è§„èŒƒæ–‡æ¡£ï¼ˆå¦‚æœ¬æ–‡æ¡£ï¼‰
- âœ… ä¿ç•™æ‰€æœ‰å½“å‰é˜¶æ®µçš„åˆ†ææ–‡æ¡£ï¼ˆå¦‚SESSION-SUMMARY-*.mdï¼‰
- âœ… ä¿ç•™æ‰€æœ‰æœªå®Œæˆä»»åŠ¡çš„å…³è”æ–‡æ¡£
- âœ… æ–‡æ¡£å‘½ååŒ…å«æ—¥æœŸï¼ˆä¾¿äºè¿½æº¯ï¼‰ï¼šå¦‚ `M1-M8-COMPLETE-FIELD-MAPPING-TABLE-2025-11-14.md`
- âœ… æ–‡æ¡£å¿…é¡»æœ‰çŠ¶æ€æ ‡è®°ï¼šâœ… å·²å®Œæˆ | ğŸš§ è¿›è¡Œä¸­ | ğŸ“‹ è‰ç¨¿

**ç¤ºä¾‹ç»“æ„**ï¼š
```
docs/
â”œâ”€â”€ DATA-USAGE-SPECIFICATION.md                          # âœ… ç”Ÿäº§ç¯å¢ƒè§„èŒƒ
â”œâ”€â”€ DATA-COLLECTION-STANDARD.md                          # âœ… ç”Ÿäº§ç¯å¢ƒè§„èŒƒ
â”œâ”€â”€ MVP-2.0-ä»»åŠ¡æ¸…å•.md                                  # âœ… SSOTï¼ˆç¬¬1å±‚ï¼‰
â”œâ”€â”€ SESSION-SUMMARY-2025-11-14-M1-M8-DATA-FIX.md        # âœ… ä¼šè¯æ€»ç»“ï¼ˆç¬¬2å±‚ï¼‰
â”œâ”€â”€ M1-M8-COMPLETE-FIELD-MAPPING-TABLE.md               # âœ… åˆ†ææ–‡æ¡£ï¼ˆç¬¬2å±‚ï¼‰
â”œâ”€â”€ CRITICAL-ISSUE-POSTMORTEM-2025-11-13.md             # âœ… äº‹ååˆ†æï¼ˆç¬¬2å±‚ï¼‰
â””â”€â”€ ...
```

---

### è§„åˆ™D2: å†å²å½’æ¡£å±‚ï¼ˆdocs/archive/ï¼‰

**é€‚ç”¨èŒƒå›´**ï¼šåºŸå¼ƒä½†æœ‰å‚è€ƒä»·å€¼çš„æ–‡æ¡£

**å½’æ¡£æ¡ä»¶**ï¼ˆæ»¡è¶³ä»»ä¸€æ¡ä»¶å³å½’æ¡£ï¼‰ï¼š
- æ–‡æ¡£å·²è¢«æ–°ç‰ˆæœ¬æ›¿ä»£ï¼Œä½†æœ‰å†å²å‚è€ƒä»·å€¼
- æ–‡æ¡£å†…å®¹è¿‡æ—¶ï¼Œä½†æ–¹æ³•è®ºä»æœ‰å€Ÿé‰´æ„ä¹‰
- é‡è¦ä¼šè¯çš„å†å²å¿«ç…§ï¼ˆ6ä¸ªæœˆåï¼‰
- å·²å®Œæˆä»»åŠ¡çš„ä¸´æ—¶åˆ†ææ–‡æ¡£ï¼ˆä¿ç•™3ä¸ªæœˆï¼‰

**å½’æ¡£è§„åˆ™**ï¼š
- âœ… å½’æ¡£æ—¶æ·»åŠ  `ARCHIVED-` å‰ç¼€æˆ–ç§»è‡³ `archive/` ç›®å½•
- âœ… å½’æ¡£æ–‡æ¡£å¤´éƒ¨æ·»åŠ  `âš ï¸ å·²å½’æ¡£` æ ‡è®°å’Œå½’æ¡£åŸå› 
- âœ… å½’æ¡£æ–‡æ¡£ä¿ç•™è‡³å°‘6ä¸ªæœˆ
- âœ… å½’æ¡£æ—¶è®°å½•æ›¿ä»£æ–‡æ¡£é“¾æ¥

**ç¤ºä¾‹ç»“æ„**ï¼š
```
docs/archive/
â”œâ”€â”€ README-original.md                                    # âœ… åŸå§‹READMEï¼ˆå·²è¢«æ–°ç‰ˆæ›¿ä»£ï¼‰
â”œâ”€â”€ ARCHIVED-POC-PLAN-V1.md                               # âœ… POC v1è®¡åˆ’ï¼ˆå·²å®Œæˆï¼‰
â”œâ”€â”€ SESSION-2025-11-01-DATA-IMPORT.md                     # âœ… å†å²ä¼šè¯å¿«ç…§
â””â”€â”€ ...
```

**å½’æ¡£æ–‡æ¡£å¤´éƒ¨ç¤ºä¾‹**ï¼š
```markdown
# ğŸ—„ï¸ ARCHIVED - POCå®æ–½è®¡åˆ’ v1.0

> âš ï¸ **å·²å½’æ¡£**
> - å½’æ¡£æ—¥æœŸï¼š2025-11-10
> - å½’æ¡£åŸå› ï¼šPOCå·²å®Œæˆï¼Œå‡çº§ä¸ºMVP 2.0
> - æ›¿ä»£æ–‡æ¡£ï¼š[MVP-2.0-è¯¦ç»†è§„åˆ’æ–¹æ¡ˆ.md](../MVP-2.0-è¯¦ç»†è§„åˆ’æ–¹æ¡ˆ.md)
> - ä¿ç•™ä»·å€¼ï¼šPOCé˜¶æ®µçš„æŠ€æœ¯å†³ç­–å’Œç»éªŒæ€»ç»“

ï¼ˆåŸæ–‡æ¡£å†…å®¹...ï¼‰
```

---

### è§„åˆ™D3: Gitåˆ é™¤å±‚

**é€‚ç”¨èŒƒå›´**ï¼šå®Œå…¨è¿‡æ—¶ã€æ— å‚è€ƒä»·å€¼çš„æ–‡æ¡£

**åˆ é™¤æ¡ä»¶**ï¼ˆå¿…é¡»æ»¡è¶³ä»¥ä¸‹ALLæ¡ä»¶ï¼‰ï¼š
- æ–‡æ¡£å†…å®¹å®Œå…¨é”™è¯¯æˆ–è¯¯å¯¼æ€§
- ä¸´æ—¶æµ‹è¯•æ–‡æ¡£å·²å®ŒæˆéªŒè¯ä¸”æ— ä¿ç•™ä»·å€¼
- é‡å¤æ–‡æ¡£ï¼ˆå†…å®¹ä¸å…¶ä»–æ–‡æ¡£100%é‡å¤ï¼‰
- 6ä¸ªæœˆæœªè¢«å¼•ç”¨çš„å½’æ¡£æ–‡æ¡£

**åˆ é™¤è§„åˆ™**ï¼š
- âœ… åˆ é™¤å‰åœ¨Git commit messageä¸­è¯´æ˜åˆ é™¤åŸå› 
- âœ… é‡è¦æ–‡æ¡£åˆ é™¤å‰å…ˆå½’æ¡£è‡³ `archive/`ï¼ˆåŒé‡ä¿é™©ï¼‰
- âŒ **ç¦æ­¢**ï¼šç›´æ¥åˆ é™¤ç”Ÿäº§ç¯å¢ƒè§„èŒƒæ–‡æ¡£
- âŒ **ç¦æ­¢**ï¼šåˆ é™¤æœªå½’æ¡£çš„ä¼šè¯æ€»ç»“æ–‡æ¡£

**åˆ é™¤ç¤ºä¾‹**ï¼š
```bash
# Git commit messageç¤ºä¾‹
git commit -m "æ¸…ç†ï¼šåˆ é™¤è¿‡æ—¶çš„ä¸´æ—¶æµ‹è¯•æ–‡æ¡£

åˆ é™¤æ–‡æ¡£ï¼š
- tmp-test-results-2025-11-01.mdï¼ˆå·²å®ŒæˆéªŒè¯ï¼Œæ— ä¿ç•™ä»·å€¼ï¼‰
- DUPLICATE-DATA-STANDARD.mdï¼ˆä¸DATA-COLLECTION-STANDARD.mdå®Œå…¨é‡å¤ï¼‰

ä¿ç•™ä¾æ®ï¼š
- ä¸´æ—¶æµ‹è¯•æ–‡æ¡£å·²éªŒè¯é€šè¿‡ï¼Œç»“æœå·²åˆå¹¶åˆ°æ­£å¼æ–‡æ¡£
- é‡å¤æ–‡æ¡£å†…å®¹100%ç›¸åŒï¼Œä¿ç•™ä¸»æ–‡æ¡£å³å¯
- å½’æ¡£æ–‡ä»¶å¤¹ä¸­å·²æœ‰6ä¸ªæœˆæœªå¼•ç”¨çš„æ—§ç‰ˆæœ¬å¯åˆ é™¤
"
```

**åˆ é™¤å†³ç­–æ ‘**ï¼š
```
æ–‡æ¡£æ˜¯å¦è¿‡æ—¶ï¼Ÿ
â”œâ”€ å¦ â†’ ä¿ç•™åœ¨ docs/
â””â”€ æ˜¯ â†’ æœ‰å‚è€ƒä»·å€¼ï¼Ÿ
    â”œâ”€ æ˜¯ â†’ å½’æ¡£åˆ° docs/archive/
    â””â”€ å¦ â†’ å®Œå…¨é‡å¤æˆ–é”™è¯¯ï¼Ÿ
        â”œâ”€ æ˜¯ â†’ Gitåˆ é™¤ï¼ˆè®°å½•åŸå› ï¼‰
        â””â”€ å¦ â†’ å½’æ¡£åˆ° docs/archive/ï¼ˆä¿é™©èµ·è§ï¼‰
```

---

## âœ… ç¬¬9ç« ï¼šv2.0è§„èŒƒéªŒæ”¶æ¸…å•

### ä»£ç ç¼–å†™éªŒæ”¶ï¼ˆæ–°å¢ï¼‰

**æ¡ä»¶æ¸²æŸ“ï¼ˆè§„èŒƒC1ï¼‰**ï¼š
- [ ] æ‰€æœ‰æ•°å€¼å­—æ®µä½¿ç”¨ `(value ?? 0) > 0 &&`
- [ ] æ‰€æœ‰å¸ƒå°”å­—æ®µä½¿ç”¨ `!!value &&`
- [ ] æ‰€æœ‰å­—ç¬¦ä¸²å­—æ®µä½¿ç”¨ `!!value &&` æˆ– `value?.length > 0 &&`
- [ ] æ²¡æœ‰ç›´æ¥ä½¿ç”¨ `value &&` çš„æ•°å€¼åˆ¤æ–­
- [ ] è¿è¡Œgrepå‘½ä»¤éªŒè¯æ— é—®é¢˜ä»£ç 

**Nullish Coalescingï¼ˆè§„èŒƒC2ï¼‰**ï¼š
- [ ] æ•°å€¼å­—æ®µä¼˜å…ˆçº§é“¾ä½¿ç”¨ `??` è€Œé `||`
- [ ] å¸ƒå°”å­—æ®µä½¿ç”¨ `??` æˆ–æ˜¾å¼æ£€æŸ¥
- [ ] å­—ç¬¦ä¸²å­—æ®µä¼˜å…ˆä½¿ç”¨ `??`ï¼ˆè¯­ä¹‰æ¸…æ™°ï¼‰

**å­—æ®µæ˜ å°„ï¼ˆè§„èŒƒC3ï¼‰**ï¼š
- [ ] æ‰€æœ‰æ˜ å°„æœ‰>=2çº§ä¼˜å…ˆçº§é“¾
- [ ] æœ€åä¸€çº§æ˜¯æ˜ç¡®çš„é»˜è®¤å€¼
- [ ] æ•°å€¼å­—æ®µä½¿ç”¨ `??`

**ç±»å‹æ–­è¨€ï¼ˆè§„èŒƒC4ï¼‰**ï¼š
- [ ] åŠ¨æ€è®¿é—®å­—æ®µä½¿ç”¨ `as any` æ˜¾å¼æ ‡æ³¨
- [ ] é‡è¦ç±»å‹è½¬æ¢æœ‰æ³¨é‡Šè¯´æ˜

**ä»£ç ç»„ç»‡ï¼ˆè§„èŒƒC5ï¼‰**ï¼š
- [ ] å­—æ®µæŒ‰M1-M8æ¨¡å—åˆ†ç»„
- [ ] å…³é”®å­—æ®µæœ‰è¡Œå†…æ³¨é‡Š

### æ–‡æ¡£ç®¡ç†éªŒæ”¶ï¼ˆæ–°å¢ï¼‰

**é¡¹ç›®æ–‡æ¡£ï¼ˆè§„åˆ™D1ï¼‰**ï¼š
- [ ] æ–‡æ¡£æœ‰çŠ¶æ€æ ‡è®°ï¼ˆâœ… å·²å®Œæˆ | ğŸš§ è¿›è¡Œä¸­ | ğŸ“‹ è‰ç¨¿ï¼‰
- [ ] æ–‡æ¡£å‘½ååŒ…å«æ—¥æœŸï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] æ–‡æ¡£å¤´éƒ¨æœ‰åˆ›å»ºæ—¥æœŸã€ç‰ˆæœ¬ã€é€‚ç”¨èŒƒå›´

**å†å²å½’æ¡£ï¼ˆè§„åˆ™D2ï¼‰**ï¼š
- [ ] å½’æ¡£æ–‡æ¡£æœ‰ `âš ï¸ å·²å½’æ¡£` æ ‡è®°
- [ ] å½’æ¡£åŸå› è¯´æ˜
- [ ] æ›¿ä»£æ–‡æ¡£é“¾æ¥
- [ ] ä¿ç•™ä»·å€¼è¯´æ˜

**æ–‡æ¡£åˆ é™¤ï¼ˆè§„åˆ™D3ï¼‰**ï¼š
- [ ] Git commit messageè¯´æ˜åˆ é™¤åŸå› 
- [ ] é‡è¦æ–‡æ¡£å·²å…ˆå½’æ¡£
- [ ] éç”Ÿäº§ç¯å¢ƒè§„èŒƒæ–‡æ¡£

---

## ğŸ“ å˜æ›´æ—¥å¿—ï¼ˆæ›´æ–°ï¼‰

**v1.0 (2025-11-13)**:
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- å®Œæ•´4ä¸ªæ ¸å¿ƒè§„èŒƒï¼ˆå¼ºåˆ¶2ä¸ª + æ¨è2ä¸ªï¼‰
- 3ä¸ªåæ¨¡å¼æ¡ˆä¾‹ + æ­£ç¡®åšæ³•å¯¹æ¯”
- 3ä¸ªå®Œæ•´ä»£ç ç¤ºä¾‹ï¼ˆé™æ€/åŠ¨æ€/æ‰¹é‡ï¼‰
- 5ç« å­—æ®µå‘½åçº¦å®šå‚è€ƒè¡¨
- å®Œæ•´éªŒæ”¶æ¸…å•

**v2.0 (2025-11-14)**: â­ é‡è¦æ›´æ–°
- âœ… æ–°å¢ç¬¬7ç« ï¼šä»£ç ç¼–å†™è§„èŒƒï¼ˆåŸºäº34å­—æ®µæ˜ å°„+28æ¡ä»¶æ¸²æŸ“ä¿®å¤ç»éªŒï¼‰
  - è§„èŒƒC1: æ¡ä»¶æ¸²æŸ“ç±»å‹å®‰å…¨ï¼ˆå¼ºåˆ¶ï¼‰
  - è§„èŒƒC2: Nullish Coalescingä½¿ç”¨ï¼ˆæ¨èï¼‰
  - è§„èŒƒC3: å­—æ®µæ˜ å°„ä¼˜å…ˆçº§é“¾ï¼ˆå¼ºåˆ¶ï¼‰
  - è§„èŒƒC4: TypeScriptç±»å‹æ–­è¨€ï¼ˆæ¨èï¼‰
  - è§„èŒƒC5: å­—æ®µåˆ†ç»„æ³¨é‡Šï¼ˆæ¨èï¼‰
- âœ… æ–°å¢ç¬¬8ç« ï¼šæ–‡æ¡£ç®¡ç†3å±‚è§„åˆ™ï¼ˆD1-D3ï¼‰
  - D1: é¡¹ç›®æ–‡æ¡£å±‚ï¼ˆdocs/ï¼‰
  - D2: å†å²å½’æ¡£å±‚ï¼ˆdocs/archive/ï¼‰
  - D3: Gitåˆ é™¤å±‚
- âœ… æ–°å¢ç¬¬9ç« ï¼šv2.0è§„èŒƒéªŒæ”¶æ¸…å•
- âœ… æ›´æ–°æ–‡æ¡£å¤´éƒ¨ç‰ˆæœ¬ä¿¡æ¯
- âœ… åŸºäºå®é™…bugä¿®å¤æ€»ç»“ï¼Œè§„èŒƒæ›´å…·å®è·µæŒ‡å¯¼æ€§
